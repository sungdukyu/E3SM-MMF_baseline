2023-05-25 03:12:28.438128: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-25 03:12:37.482201: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-05-25 03:12:55.468822: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/jet/home/jlin96/.conda/envs/tf2/lib/:/jet/home/jlin96/.conda/envs/tf2/lib/
2023-05-25 03:12:55.469499: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/jet/home/jlin96/.conda/envs/tf2/lib/:/jet/home/jlin96/.conda/envs/tf2/lib/
2023-05-25 03:12:55.469513: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-05-25 03:13:39.700451: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-25 03:13:41.736709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14615 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 7.0
<< set_environment START >>
node name: v031
procid:    3
oracle ip: v031
SY DEBUG: procid-3 / GPU-ID-3
KERASTUNER_TUNER_ID:    tuner-v031-3
KERASTUNER_ORACLE_IP:   v031.ib.bridges2.psc.edu
KERASTUNER_ORACLE_PORT: 8000
<< set_environment END >>
(atm200007p) after-set_env
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Model: "trial_model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input (InputLayer)             [(None, 124)]        0           []                               
                                                                                                  
 dense (Dense)                  (None, 128)          16000       ['input[0][0]']                  
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 128)          0           ['dense[0][0]']                  
                                                                                                  
 dense_1 (Dense)                (None, 128)          16512       ['leaky_re_lu[0][0]']            
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 128)          0           ['dense_1[0][0]']                
                                                                                                  
 dense_2 (Dense)                (None, 128)          16512       ['leaky_re_lu_1[0][0]']          
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 128)          0           ['dense_2[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 128)          16512       ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 128)          0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 128)          16512       ['leaky_re_lu_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 128)          0           ['dense_4[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 120)          15480       ['leaky_re_lu_4[0][0]']          
                                                                                                  
 dense_6 (Dense)                (None, 8)            1032        ['leaky_re_lu_4[0][0]']          
                                                                                                  
 concatenate (Concatenate)      (None, 128)          0           ['dense_5[0][0]',                
                                                                  'dense_6[0][0]']                
                                                                                                  
==================================================================================================
Total params: 98,560
Trainable params: 98,560
Non-trainable params: 0
__________________________________________________________________________________________________
None
---SEARCH SPACE---
Search space summary
Default search space size: 8
lr (Float)
{'default': 0.0001, 'conditions': [], 'min_value': 0.0001, 'max_value': 0.001, 'step': None, 'sampling': 'log'}
num_layers (Int)
{'default': 4, 'conditions': [], 'min_value': 4, 'max_value': 12, 'step': 1, 'sampling': None}
units_0 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
units_1 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
units_2 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
units_3 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
batch_size (Choice)
{'default': 3072, 'conditions': [], 'values': [48, 96, 192, 384, 768, 1152, 1536, 2304, 3072], 'ordered': True}
optimizer (Choice)
{'default': 'Adam', 'conditions': [], 'values': ['Adam', 'RAdam', 'QHAdam'], 'ordered': False}

Search: Running Trial #4

Value             |Best Value So Far |Hyperparameter
0.00020446        |?                 |lr
10                |?                 |num_layers
896               |?                 |units_0
768               |?                 |units_1
1024              |?                 |units_2
256               |?                 |units_3
96                |?                 |batch_size
RAdam             |?                 |optimizer

Model: "trial_model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input (InputLayer)             [(None, 124)]        0           []                               
                                                                                                  
 dense (Dense)                  (None, 896)          112000      ['input[0][0]']                  
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 896)          0           ['dense[0][0]']                  
                                                                                                  
 dense_1 (Dense)                (None, 768)          688896      ['leaky_re_lu[0][0]']            
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 768)          0           ['dense_1[0][0]']                
                                                                                                  
 dense_2 (Dense)                (None, 1024)         787456      ['leaky_re_lu_1[0][0]']          
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 1024)         0           ['dense_2[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 256)          262400      ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 256)          0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 128)          32896       ['leaky_re_lu_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 128)          0           ['dense_4[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 128)          16512       ['leaky_re_lu_4[0][0]']          
                                                                                                  
 leaky_re_lu_5 (LeakyReLU)      (None, 128)          0           ['dense_5[0][0]']                
                                                                                                  
 dense_6 (Dense)                (None, 128)          16512       ['leaky_re_lu_5[0][0]']          
                                                                                                  
 leaky_re_lu_6 (LeakyReLU)      (None, 128)          0           ['dense_6[0][0]']                
                                                                                                  
 dense_7 (Dense)                (None, 128)          16512       ['leaky_re_lu_6[0][0]']          
                                                                                                  
 leaky_re_lu_7 (LeakyReLU)      (None, 128)          0           ['dense_7[0][0]']                
                                                                                                  
 dense_8 (Dense)                (None, 128)          16512       ['leaky_re_lu_7[0][0]']          
                                                                                                  
 leaky_re_lu_8 (LeakyReLU)      (None, 128)          0           ['dense_8[0][0]']                
                                                                                                  
 dense_9 (Dense)                (None, 128)          16512       ['leaky_re_lu_8[0][0]']          
                                                                                                  
 leaky_re_lu_9 (LeakyReLU)      (None, 128)          0           ['dense_9[0][0]']                
                                                                                                  
 dense_10 (Dense)               (None, 128)          16512       ['leaky_re_lu_9[0][0]']          
                                                                                                  
 leaky_re_lu_10 (LeakyReLU)     (None, 128)          0           ['dense_10[0][0]']               
                                                                                                  
 dense_11 (Dense)               (None, 120)          15480       ['leaky_re_lu_10[0][0]']         
                                                                                                  
 dense_12 (Dense)               (None, 8)            1032        ['leaky_re_lu_10[0][0]']         
                                                                                                  
 concatenate (Concatenate)      (None, 128)          0           ['dense_11[0][0]',               
                                                                  'dense_12[0][0]']               
                                                                                                  
==================================================================================================
Total params: 1,999,232
Trainable params: 1,999,232
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/12
2023-05-25 03:13:58.355830: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 11137 of 11520
2023-05-25 03:13:58.357047: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
17116/17116 - 1663s - loss: 0.0054 - mse: 0.0054 - mae: 0.0284 - accuracy: 0.9683 - val_loss: 0.0043 - val_mse: 0.0043 - val_mae: 0.0251 - val_accuracy: 0.9727 - 1663s/epoch - 97ms/step
Epoch 2/12
17116/17116 - 774s - loss: 0.0042 - mse: 0.0042 - mae: 0.0246 - accuracy: 0.9752 - val_loss: 0.0042 - val_mse: 0.0042 - val_mae: 0.0246 - val_accuracy: 0.9751 - 774s/epoch - 45ms/step
Epoch 3/12
17116/17116 - 841s - loss: 0.0041 - mse: 0.0041 - mae: 0.0239 - accuracy: 0.9762 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0242 - val_accuracy: 0.9764 - 841s/epoch - 49ms/step
Epoch 4/12
17116/17116 - 826s - loss: 0.0040 - mse: 0.0040 - mae: 0.0236 - accuracy: 0.9771 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0235 - val_accuracy: 0.9759 - 826s/epoch - 48ms/step
Epoch 5/12
17116/17116 - 740s - loss: 0.0039 - mse: 0.0039 - mae: 0.0233 - accuracy: 0.9777 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0232 - val_accuracy: 0.9779 - 740s/epoch - 43ms/step
Epoch 6/12
17116/17116 - 832s - loss: 0.0039 - mse: 0.0039 - mae: 0.0231 - accuracy: 0.9783 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0232 - val_accuracy: 0.9772 - 832s/epoch - 49ms/step
Epoch 7/12
17116/17116 - 908s - loss: 0.0039 - mse: 0.0039 - mae: 0.0229 - accuracy: 0.9787 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0232 - val_accuracy: 0.9778 - 908s/epoch - 53ms/step
Epoch 8/12
17116/17116 - 902s - loss: 0.0038 - mse: 0.0038 - mae: 0.0228 - accuracy: 0.9790 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0231 - val_accuracy: 0.9777 - 902s/epoch - 53ms/step
Epoch 9/12
17116/17116 - 956s - loss: 0.0038 - mse: 0.0038 - mae: 0.0227 - accuracy: 0.9792 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0227 - val_accuracy: 0.9789 - 956s/epoch - 56ms/step
Epoch 10/12
17116/17116 - 861s - loss: 0.0038 - mse: 0.0038 - mae: 0.0226 - accuracy: 0.9794 - val_loss: 0.0038 - val_mse: 0.0038 - val_mae: 0.0228 - val_accuracy: 0.9790 - 861s/epoch - 50ms/step
Epoch 11/12
17116/17116 - 844s - loss: 0.0038 - mse: 0.0038 - mae: 0.0225 - accuracy: 0.9796 - val_loss: 0.0038 - val_mse: 0.0038 - val_mae: 0.0226 - val_accuracy: 0.9793 - 844s/epoch - 49ms/step
Epoch 12/12
17116/17116 - 832s - loss: 0.0038 - mse: 0.0038 - mae: 0.0225 - accuracy: 0.9798 - val_loss: 0.0038 - val_mse: 0.0038 - val_mae: 0.0227 - val_accuracy: 0.9787 - 832s/epoch - 49ms/step
[2K[2KTrial 4 Complete [03h 06m 31s]
val_loss: 0.0038229837082326412

Best val_loss So Far: 0.0038229837082326412
Total elapsed time: 03h 06m 31s

Search: Running Trial #8

Value             |Best Value So Far |Hyperparameter
0.00025315        |0.00020446        |lr
8                 |10                |num_layers
640               |896               |units_0
768               |768               |units_1
256               |1024              |units_2
896               |256               |units_3
256               |None              |units_4
512               |None              |units_5
256               |None              |units_6
256               |None              |units_7
128               |None              |units_8
512               |None              |units_9
1152              |96                |batch_size
Adam              |RAdam             |optimizer

Model: "trial_model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input (InputLayer)             [(None, 124)]        0           []                               
                                                                                                  
 dense (Dense)                  (None, 640)          80000       ['input[0][0]']                  
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 640)          0           ['dense[0][0]']                  
                                                                                                  
 dense_1 (Dense)                (None, 768)          492288      ['leaky_re_lu[0][0]']            
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 768)          0           ['dense_1[0][0]']                
                                                                                                  
 dense_2 (Dense)                (None, 256)          196864      ['leaky_re_lu_1[0][0]']          
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 256)          0           ['dense_2[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 896)          230272      ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 896)          0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 256)          229632      ['leaky_re_lu_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 256)          0           ['dense_4[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 512)          131584      ['leaky_re_lu_4[0][0]']          
                                                                                                  
 leaky_re_lu_5 (LeakyReLU)      (None, 512)          0           ['dense_5[0][0]']                
                                                                                                  
 dense_6 (Dense)                (None, 256)          131328      ['leaky_re_lu_5[0][0]']          
                                                                                                  
 leaky_re_lu_6 (LeakyReLU)      (None, 256)          0           ['dense_6[0][0]']                
                                                                                                  
 dense_7 (Dense)                (None, 256)          65792       ['leaky_re_lu_6[0][0]']          
                                                                                                  
 leaky_re_lu_7 (LeakyReLU)      (None, 256)          0           ['dense_7[0][0]']                
                                                                                                  
 dense_8 (Dense)                (None, 128)          32896       ['leaky_re_lu_7[0][0]']          
                                                                                                  
 leaky_re_lu_8 (LeakyReLU)      (None, 128)          0           ['dense_8[0][0]']                
                                                                                                  
 dense_9 (Dense)                (None, 120)          15480       ['leaky_re_lu_8[0][0]']          
                                                                                                  
 dense_10 (Dense)               (None, 8)            1032        ['leaky_re_lu_8[0][0]']          
                                                                                                  
 concatenate (Concatenate)      (None, 128)          0           ['dense_9[0][0]',                
                                                                  'dense_10[0][0]']               
                                                                                                  
==================================================================================================
Total params: 1,607,168
Trainable params: 1,607,168
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/12
2023-05-25 06:20:31.815097: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 11137 of 11520
2023-05-25 06:20:31.816211: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
1427/1427 - 692s - loss: 0.0055 - mse: 0.0055 - mae: 0.0310 - accuracy: 0.9634 - val_loss: 0.0044 - val_mse: 0.0044 - val_mae: 0.0269 - val_accuracy: 0.9717 - 692s/epoch - 485ms/step
Epoch 2/12
2023-05-25 06:32:53.918865: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 4609 of 11520
2023-05-25 06:32:56.858498: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
1427/1427 - 714s - loss: 0.0043 - mse: 0.0043 - mae: 0.0261 - accuracy: 0.9739 - val_loss: 0.0044 - val_mse: 0.0044 - val_mae: 0.0265 - val_accuracy: 0.9747 - 714s/epoch - 500ms/step
Epoch 3/12
2023-05-25 06:45:15.693312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 2305 of 11520
2023-05-25 06:45:20.040042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
1427/1427 - 702s - loss: 0.0041 - mse: 0.0041 - mae: 0.0251 - accuracy: 0.9758 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0247 - val_accuracy: 0.9749 - 702s/epoch - 492ms/step
Epoch 4/12
2023-05-25 06:57:38.118297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 10753 of 11520
2023-05-25 06:57:38.299431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
2023-05-25 06:57:38.495978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 1 of 11520
2023-05-25 06:57:45.381655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
1427/1427 - 718s - loss: 0.0040 - mse: 0.0040 - mae: 0.0246 - accuracy: 0.9770 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0246 - val_accuracy: 0.9762 - 718s/epoch - 503ms/step
Epoch 5/12
1427/1427 - 691s - loss: 0.0040 - mse: 0.0040 - mae: 0.0242 - accuracy: 0.9776 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0240 - val_accuracy: 0.9781 - 691s/epoch - 484ms/step
Epoch 6/12
1427/1427 - 691s - loss: 0.0039 - mse: 0.0039 - mae: 0.0239 - accuracy: 0.9782 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0238 - val_accuracy: 0.9779 - 691s/epoch - 484ms/step
Epoch 7/12
2023-05-25 07:43:56.345673: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 6145 of 11520
2023-05-25 07:43:58.086298: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
1427/1427 - 695s - loss: 0.0039 - mse: 0.0039 - mae: 0.0236 - accuracy: 0.9785 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0238 - val_accuracy: 0.9787 - 695s/epoch - 487ms/step
Epoch 8/12
2023-05-25 07:46:14.788082: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 1153 of 11520
2023-05-25 07:46:21.949578: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
2023-05-25 07:56:04.157759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 11137 of 11520
2023-05-25 07:56:04.159015: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
1427/1427 - 731s - loss: 0.0039 - mse: 0.0039 - mae: 0.0234 - accuracy: 0.9789 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0239 - val_accuracy: 0.9773 - 731s/epoch - 512ms/step
Epoch 9/12
2023-05-25 07:58:25.890486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 3073 of 11520
2023-05-25 07:58:28.857810: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
1427/1427 - 733s - loss: 0.0038 - mse: 0.0038 - mae: 0.0233 - accuracy: 0.9791 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0235 - val_accuracy: 0.9786 - 733s/epoch - 513ms/step
Epoch 10/12

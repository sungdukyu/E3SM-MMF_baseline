2023-05-25 03:12:28.438123: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-25 03:12:37.482201: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-05-25 03:12:55.468817: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/jet/home/jlin96/.conda/envs/tf2/lib/:/jet/home/jlin96/.conda/envs/tf2/lib/
2023-05-25 03:12:55.469498: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/jet/home/jlin96/.conda/envs/tf2/lib/:/jet/home/jlin96/.conda/envs/tf2/lib/
2023-05-25 03:12:55.469513: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-05-25 03:13:39.700490: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-25 03:13:41.736691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14615 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
<< set_environment START >>
node name: v031
procid:    1
oracle ip: v031
SY DEBUG: procid-1 / GPU-ID-1
KERASTUNER_TUNER_ID:    tuner-v031-1
KERASTUNER_ORACLE_IP:   v031.ib.bridges2.psc.edu
KERASTUNER_ORACLE_PORT: 8000
<< set_environment END >>
(atm200007p) after-set_env
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Model: "trial_model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input (InputLayer)             [(None, 124)]        0           []                               
                                                                                                  
 dense (Dense)                  (None, 128)          16000       ['input[0][0]']                  
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 128)          0           ['dense[0][0]']                  
                                                                                                  
 dense_1 (Dense)                (None, 128)          16512       ['leaky_re_lu[0][0]']            
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 128)          0           ['dense_1[0][0]']                
                                                                                                  
 dense_2 (Dense)                (None, 128)          16512       ['leaky_re_lu_1[0][0]']          
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 128)          0           ['dense_2[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 128)          16512       ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 128)          0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 128)          16512       ['leaky_re_lu_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 128)          0           ['dense_4[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 120)          15480       ['leaky_re_lu_4[0][0]']          
                                                                                                  
 dense_6 (Dense)                (None, 8)            1032        ['leaky_re_lu_4[0][0]']          
                                                                                                  
 concatenate (Concatenate)      (None, 128)          0           ['dense_5[0][0]',                
                                                                  'dense_6[0][0]']                
                                                                                                  
==================================================================================================
Total params: 98,560
Trainable params: 98,560
Non-trainable params: 0
__________________________________________________________________________________________________
None
---SEARCH SPACE---
Search space summary
Default search space size: 8
lr (Float)
{'default': 0.0001, 'conditions': [], 'min_value': 0.0001, 'max_value': 0.001, 'step': None, 'sampling': 'log'}
num_layers (Int)
{'default': 4, 'conditions': [], 'min_value': 4, 'max_value': 12, 'step': 1, 'sampling': None}
units_0 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
units_1 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
units_2 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
units_3 (Int)
{'default': 128, 'conditions': [], 'min_value': 128, 'max_value': 1024, 'step': 128, 'sampling': None}
batch_size (Choice)
{'default': 3072, 'conditions': [], 'values': [48, 96, 192, 384, 768, 1152, 1536, 2304, 3072], 'ordered': True}
optimizer (Choice)
{'default': 'Adam', 'conditions': [], 'values': ['Adam', 'RAdam', 'QHAdam'], 'ordered': False}

Search: Running Trial #3

Value             |Best Value So Far |Hyperparameter
0.00049896        |?                 |lr
9                 |?                 |num_layers
640               |?                 |units_0
896               |?                 |units_1
384               |?                 |units_2
768               |?                 |units_3
192               |?                 |batch_size
Adam              |?                 |optimizer

Model: "trial_model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input (InputLayer)             [(None, 124)]        0           []                               
                                                                                                  
 dense (Dense)                  (None, 640)          80000       ['input[0][0]']                  
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 640)          0           ['dense[0][0]']                  
                                                                                                  
 dense_1 (Dense)                (None, 896)          574336      ['leaky_re_lu[0][0]']            
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 896)          0           ['dense_1[0][0]']                
                                                                                                  
 dense_2 (Dense)                (None, 384)          344448      ['leaky_re_lu_1[0][0]']          
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 384)          0           ['dense_2[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 768)          295680      ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 768)          0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 128)          98432       ['leaky_re_lu_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 128)          0           ['dense_4[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 128)          16512       ['leaky_re_lu_4[0][0]']          
                                                                                                  
 leaky_re_lu_5 (LeakyReLU)      (None, 128)          0           ['dense_5[0][0]']                
                                                                                                  
 dense_6 (Dense)                (None, 128)          16512       ['leaky_re_lu_5[0][0]']          
                                                                                                  
 leaky_re_lu_6 (LeakyReLU)      (None, 128)          0           ['dense_6[0][0]']                
                                                                                                  
 dense_7 (Dense)                (None, 128)          16512       ['leaky_re_lu_6[0][0]']          
                                                                                                  
 leaky_re_lu_7 (LeakyReLU)      (None, 128)          0           ['dense_7[0][0]']                
                                                                                                  
 dense_8 (Dense)                (None, 128)          16512       ['leaky_re_lu_7[0][0]']          
                                                                                                  
 leaky_re_lu_8 (LeakyReLU)      (None, 128)          0           ['dense_8[0][0]']                
                                                                                                  
 dense_9 (Dense)                (None, 128)          16512       ['leaky_re_lu_8[0][0]']          
                                                                                                  
 leaky_re_lu_9 (LeakyReLU)      (None, 128)          0           ['dense_9[0][0]']                
                                                                                                  
 dense_10 (Dense)               (None, 120)          15480       ['leaky_re_lu_9[0][0]']          
                                                                                                  
 dense_11 (Dense)               (None, 8)            1032        ['leaky_re_lu_9[0][0]']          
                                                                                                  
 concatenate (Concatenate)      (None, 128)          0           ['dense_10[0][0]',               
                                                                  'dense_11[0][0]']               
                                                                                                  
==================================================================================================
Total params: 1,491,968
Trainable params: 1,491,968
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/12
8558/8558 - 1600s - loss: 0.0048 - mse: 0.0048 - mae: 0.0273 - accuracy: 0.9712 - val_loss: 0.0045 - val_mse: 0.0045 - val_mae: 0.0258 - val_accuracy: 0.9737 - 1600s/epoch - 187ms/step
Epoch 2/12
8558/8558 - 654s - loss: 0.0043 - mse: 0.0043 - mae: 0.0248 - accuracy: 0.9752 - val_loss: 0.0043 - val_mse: 0.0043 - val_mae: 0.0245 - val_accuracy: 0.9748 - 654s/epoch - 76ms/step
Epoch 3/12
8558/8558 - 774s - loss: 0.0041 - mse: 0.0041 - mae: 0.0241 - accuracy: 0.9763 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0239 - val_accuracy: 0.9768 - 774s/epoch - 90ms/step
Epoch 4/12
8558/8558 - 801s - loss: 0.0040 - mse: 0.0040 - mae: 0.0237 - accuracy: 0.9771 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0237 - val_accuracy: 0.9759 - 801s/epoch - 94ms/step
Epoch 5/12
8558/8558 - 671s - loss: 0.0040 - mse: 0.0040 - mae: 0.0234 - accuracy: 0.9776 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0236 - val_accuracy: 0.9755 - 671s/epoch - 78ms/step
Epoch 6/12
8558/8558 - 639s - loss: 0.0039 - mse: 0.0039 - mae: 0.0233 - accuracy: 0.9779 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0235 - val_accuracy: 0.9767 - 639s/epoch - 75ms/step
Epoch 7/12
8558/8558 - 800s - loss: 0.0039 - mse: 0.0039 - mae: 0.0231 - accuracy: 0.9782 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0233 - val_accuracy: 0.9777 - 800s/epoch - 93ms/step
Epoch 8/12
8558/8558 - 655s - loss: 0.0039 - mse: 0.0039 - mae: 0.0230 - accuracy: 0.9786 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0230 - val_accuracy: 0.9772 - 655s/epoch - 77ms/step
Epoch 9/12
8558/8558 - 740s - loss: 0.0039 - mse: 0.0039 - mae: 0.0229 - accuracy: 0.9787 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0232 - val_accuracy: 0.9778 - 740s/epoch - 86ms/step
Epoch 10/12
8558/8558 - 691s - loss: 0.0038 - mse: 0.0038 - mae: 0.0228 - accuracy: 0.9790 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0230 - val_accuracy: 0.9775 - 691s/epoch - 81ms/step
Epoch 11/12
8558/8558 - 673s - loss: 0.0038 - mse: 0.0038 - mae: 0.0227 - accuracy: 0.9792 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0227 - val_accuracy: 0.9783 - 673s/epoch - 79ms/step
Epoch 12/12
8558/8558 - 704s - loss: 0.0038 - mse: 0.0038 - mae: 0.0227 - accuracy: 0.9794 - val_loss: 0.0039 - val_mse: 0.0039 - val_mae: 0.0230 - val_accuracy: 0.9770 - 704s/epoch - 82ms/step
[2K[2KTrial 3 Complete [02h 41m 27s]
val_loss: 0.003888607257977128

Best val_loss So Far: 0.0038354534190148115
Total elapsed time: 02h 41m 27s

Search: Running Trial #7

Value             |Best Value So Far |Hyperparameter
0.00025747        |0.0008532         |lr
7                 |5                 |num_layers
256               |896               |units_0
512               |896               |units_1
640               |1024              |units_2
384               |256               |units_3
768               |None              |units_4
256               |None              |units_5
512               |None              |units_6
512               |None              |units_7
256               |None              |units_8
896               |None              |units_9
3072              |768               |batch_size
QHAdam            |RAdam             |optimizer

Model: "trial_model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input (InputLayer)             [(None, 124)]        0           []                               
                                                                                                  
 dense (Dense)                  (None, 256)          32000       ['input[0][0]']                  
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 256)          0           ['dense[0][0]']                  
                                                                                                  
 dense_1 (Dense)                (None, 512)          131584      ['leaky_re_lu[0][0]']            
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 512)          0           ['dense_1[0][0]']                
                                                                                                  
 dense_2 (Dense)                (None, 640)          328320      ['leaky_re_lu_1[0][0]']          
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 640)          0           ['dense_2[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 384)          246144      ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 384)          0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 768)          295680      ['leaky_re_lu_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 768)          0           ['dense_4[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 256)          196864      ['leaky_re_lu_4[0][0]']          
                                                                                                  
 leaky_re_lu_5 (LeakyReLU)      (None, 256)          0           ['dense_5[0][0]']                
                                                                                                  
 dense_6 (Dense)                (None, 512)          131584      ['leaky_re_lu_5[0][0]']          
                                                                                                  
 leaky_re_lu_6 (LeakyReLU)      (None, 512)          0           ['dense_6[0][0]']                
                                                                                                  
 dense_7 (Dense)                (None, 128)          65664       ['leaky_re_lu_6[0][0]']          
                                                                                                  
 leaky_re_lu_7 (LeakyReLU)      (None, 128)          0           ['dense_7[0][0]']                
                                                                                                  
 dense_8 (Dense)                (None, 120)          15480       ['leaky_re_lu_7[0][0]']          
                                                                                                  
 dense_9 (Dense)                (None, 8)            1032        ['leaky_re_lu_7[0][0]']          
                                                                                                  
 concatenate (Concatenate)      (None, 128)          0           ['dense_8[0][0]',                
                                                                  'dense_9[0][0]']                
                                                                                                  
==================================================================================================
Total params: 1,444,352
Trainable params: 1,444,352
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/12
535/535 - 619s - loss: 0.0082 - mse: 0.0082 - mae: 0.0441 - accuracy: 0.9551 - val_loss: 0.0056 - val_mse: 0.0056 - val_mae: 0.0334 - val_accuracy: 0.9613 - 619s/epoch - 1s/step
Epoch 2/12
535/535 - 617s - loss: 0.0051 - mse: 0.0051 - mae: 0.0307 - accuracy: 0.9662 - val_loss: 0.0049 - val_mse: 0.0049 - val_mae: 0.0291 - val_accuracy: 0.9703 - 617s/epoch - 1s/step
Epoch 3/12
535/535 - 615s - loss: 0.0047 - mse: 0.0047 - mae: 0.0280 - accuracy: 0.9713 - val_loss: 0.0046 - val_mse: 0.0046 - val_mae: 0.0273 - val_accuracy: 0.9722 - 615s/epoch - 1s/step
Epoch 4/12
535/535 - 609s - loss: 0.0045 - mse: 0.0045 - mae: 0.0268 - accuracy: 0.9727 - val_loss: 0.0045 - val_mse: 0.0045 - val_mae: 0.0264 - val_accuracy: 0.9742 - 609s/epoch - 1s/step
Epoch 5/12
535/535 - 664s - loss: 0.0044 - mse: 0.0044 - mae: 0.0261 - accuracy: 0.9744 - val_loss: 0.0043 - val_mse: 0.0043 - val_mae: 0.0258 - val_accuracy: 0.9757 - 664s/epoch - 1s/step
Epoch 6/12
535/535 - 618s - loss: 0.0043 - mse: 0.0043 - mae: 0.0255 - accuracy: 0.9755 - val_loss: 0.0043 - val_mse: 0.0043 - val_mae: 0.0255 - val_accuracy: 0.9760 - 618s/epoch - 1s/step
Epoch 7/12
535/535 - 628s - loss: 0.0042 - mse: 0.0042 - mae: 0.0252 - accuracy: 0.9763 - val_loss: 0.0042 - val_mse: 0.0042 - val_mae: 0.0252 - val_accuracy: 0.9764 - 628s/epoch - 1s/step
Epoch 8/12
535/535 - 611s - loss: 0.0041 - mse: 0.0041 - mae: 0.0250 - accuracy: 0.9767 - val_loss: 0.0042 - val_mse: 0.0042 - val_mae: 0.0250 - val_accuracy: 0.9769 - 611s/epoch - 1s/step
Epoch 9/12
535/535 - 624s - loss: 0.0041 - mse: 0.0041 - mae: 0.0247 - accuracy: 0.9772 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0245 - val_accuracy: 0.9771 - 624s/epoch - 1s/step
Epoch 10/12
535/535 - 630s - loss: 0.0040 - mse: 0.0040 - mae: 0.0244 - accuracy: 0.9779 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0244 - val_accuracy: 0.9781 - 630s/epoch - 1s/step
Epoch 11/12
535/535 - 605s - loss: 0.0040 - mse: 0.0040 - mae: 0.0242 - accuracy: 0.9780 - val_loss: 0.0041 - val_mse: 0.0041 - val_mae: 0.0244 - val_accuracy: 0.9768 - 605s/epoch - 1s/step
Epoch 12/12
535/535 - 668s - loss: 0.0040 - mse: 0.0040 - mae: 0.0241 - accuracy: 0.9785 - val_loss: 0.0040 - val_mse: 0.0040 - val_mae: 0.0242 - val_accuracy: 0.9784 - 668s/epoch - 1s/step
[2K[2KTrial 7 Complete [02h 09m 27s]
val_loss: 0.004048771224915981

Best val_loss So Far: 0.0038025295361876488
Total elapsed time: 04h 50m 54s

Search: Running Trial #11

Value             |Best Value So Far |Hyperparameter
0.00018395        |0.00035762        |lr
6                 |5                 |num_layers
896               |896               |units_0
256               |640               |units_1
640               |640               |units_2
896               |256               |units_3
256               |896               |units_4
128               |896               |units_5
256               |384               |units_6
128               |896               |units_7
384               |640               |units_8
384               |256               |units_9
384               |None              |units_10
128               |None              |units_11
48                |1152              |batch_size
RAdam             |RAdam             |optimizer

Model: "trial_model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input (InputLayer)             [(None, 124)]        0           []                               
                                                                                                  
 dense (Dense)                  (None, 896)          112000      ['input[0][0]']                  
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 896)          0           ['dense[0][0]']                  
                                                                                                  
 dense_1 (Dense)                (None, 256)          229632      ['leaky_re_lu[0][0]']            
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 256)          0           ['dense_1[0][0]']                
                                                                                                  
 dense_2 (Dense)                (None, 640)          164480      ['leaky_re_lu_1[0][0]']          
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 640)          0           ['dense_2[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 896)          574336      ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 896)          0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 256)          229632      ['leaky_re_lu_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 256)          0           ['dense_4[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 128)          32896       ['leaky_re_lu_4[0][0]']          
                                                                                                  
 leaky_re_lu_5 (LeakyReLU)      (None, 128)          0           ['dense_5[0][0]']                
                                                                                                  
 dense_6 (Dense)                (None, 128)          16512       ['leaky_re_lu_5[0][0]']          
                                                                                                  
 leaky_re_lu_6 (LeakyReLU)      (None, 128)          0           ['dense_6[0][0]']                
                                                                                                  
 dense_7 (Dense)                (None, 120)          15480       ['leaky_re_lu_6[0][0]']          
                                                                                                  
 dense_8 (Dense)                (None, 8)            1032        ['leaky_re_lu_6[0][0]']          
                                                                                                  
 concatenate (Concatenate)      (None, 128)          0           ['dense_7[0][0]',                
                                                                  'dense_8[0][0]']                
                                                                                                  
==================================================================================================
Total params: 1,376,000
Trainable params: 1,376,000
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/12
2023-05-25 08:04:51.312228: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:390] Filling up shuffle buffer (this may take a while): 3073 of 11520
2023-05-25 08:04:53.379412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:415] Shuffle buffer filled.
